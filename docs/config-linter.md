# Конфигурация линтера и форматтера

Документ описывает настройки ESLint и Prettier в проекте, а также их интеграцию через lint-staged и Husky.

---

## ESLint

Конфигурация: `eslint.config.js` (Flat Config, формат ESLint 9+).

### Структура конфигурации

Конфиг собирается через `tseslint.config()`, который объединяет несколько объектов конфигурации в один массив. Порядок важен: последующие правила переопределяют предыдущие.

---

### 1. Игнорируемые пути (`ignores`)

```javascript
{
    ignores: ['dist', 'node_modules', 'public', '**/*.config.*', 'coverage', 'scripts']
}
```

| Путь            | Назначение                                                                                         |
| --------------- | -------------------------------------------------------------------------------------------------- |
| `dist`          | Собранный билд — не исходный код                                                                   |
| `node_modules`  | Зависимости npm                                                                                    |
| `public`        | Статические файлы (шрифты, изображения)                                                            |
| `**/*.config.*` | Файлы конфигурации (vite.config.ts, eslint.config.js и т.п.) — могут использовать другой синтаксис |
| `coverage`      | Отчёты покрытия тестами                                                                            |
| `scripts`       | Скрипты сборки/утилиты (например, download-fonts.mjs)                                              |

---

### 2. Базовые конфиги

| Конфиг                                  | Пакет                    | Описание                                                                                          |
| --------------------------------------- | ------------------------ | ------------------------------------------------------------------------------------------------- |
| `js.configs.recommended`                | `@eslint/js`             | Рекомендуемые правила для JavaScript (no-unused-vars, no-undef и др.)                             |
| `tseslint.configs.recommended`          | `typescript-eslint`      | Рекомендуемые правила для TypeScript (типизация, строгий режим)                                   |
| `pluginVue.configs['flat/recommended']` | `eslint-plugin-vue`      | Рекомендуемые правила для Vue 3 (шаблоны, SFC, best practices)                                    |
| `eslintConfigPrettier`                  | `eslint-config-prettier` | Отключает все правила ESLint, конфликтующие с Prettier (отступы, кавычки, точки с запятой и т.д.) |

---

### 3. Глобальные переменные (`languageOptions.globals`)

Применяется к `**/*.ts` и `**/*.vue`:

```javascript
globals: { ...globals.browser, HTMLElementTagNameMap: 'readonly' }
```

| Переменная              | Источник        | Описание                                                                                                                                    |
| ----------------------- | --------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| `globals.browser`       | пакет `globals` | `window`, `document`, `console`, `fetch`, `localStorage`, `setTimeout` и др. — ESLint не будет ругаться на «необъявленные» глобалы браузера |
| `HTMLElementTagNameMap` | дополнение      | TypeScript-тип для маппинга тегов HTML; помечен как `readonly`, чтобы не считать присваивание ошибкой                                       |

---

### 4. Парсер для Vue (`parserOptions`)

Только для `**/*.vue`:

```javascript
parserOptions: {
    parser: tseslint.parser,
    extraFileExtensions: ['.vue'],
}
```

| Параметр              | Значение          | Описание                                                |
| --------------------- | ----------------- | ------------------------------------------------------- |
| `parser`              | `tseslint.parser` | TypeScript-парсер для `<script>` в SFC                  |
| `extraFileExtensions` | `['.vue']`        | Разрешает ESLint обрабатывать `.vue` как валидные файлы |

---

### 5. Правила для Vue (`**/*.vue`)

| Правило                                 | Уровень | Опции                                                                 | Описание                                                                                                                                                                                                   |
| --------------------------------------- | ------- | --------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `vue/multi-word-component-names`        | `warn`  | —                                                                     | Имена компонентов должны состоять из нескольких слов (например, `UserCard`, а не `User`) — уменьшает коллизии с нативными HTML-тегами                                                                      |
| `vue/component-name-in-template-casing` | `error` | `PascalCase`, `registeredComponentsOnly: false`, `ignores: ['/^a-/']` | В шаблонах компоненты пишутся в PascalCase. `registeredComponentsOnly: false` — проверяются все теги, похожие на компоненты. `ignores: ['/^a-/']` — исключение для Ant Design Vue (`a-button`, `a-input` и т.д.) |
| `vue/require-default-prop`              | `off`   | —                                                                     | Не требовать default для опциональных props                                                                                                                                                                |
| `vue/no-required-prop-with-default`    | `off`   | —                                                                     | Разрешать required props с default (иногда нужно для типизации)                                                                                                                                            |
| `vue/attributes-order`                  | `warn`  | —                                                                     | Рекомендуемый порядок атрибутов: определение, список, условные, рендер, глобальные, уникальные, слоты, ссылки                                                                                              |
| `vue/max-attributes-per-line`           | `error` | `singleline: { max: 2 }`, `multiline: { max: 1 }`                     | До 2 атрибутов — на одной строке; при 3+ — каждый атрибут на новой строке (замыкающие `>` / `/>` тоже переносятся)                                                                                          |

---

### 6. Правила для TypeScript и Vue (`**/*.ts`, `**/*.vue`)

| Правило                                   | Уровень | Опции                                                | Описание                                                                                                                                |
| ----------------------------------------- | ------- | ---------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| `@typescript-eslint/no-unused-vars`       | `warn`  | `argsIgnorePattern: '^_'`, `varsIgnorePattern: '^_'` | Предупреждение о неиспользуемых переменных. Переменные и аргументы, начинающиеся с `_`, игнорируются (например, `_event`, `_payload`)   |
| `@typescript-eslint/no-explicit-any`      | `warn`  | —                                                    | Предупреждение при использовании типа `any` — поощряет явную типизацию                                                                  |
| `@typescript-eslint/no-empty-object-type` | `warn`  | `allowInterfaces: 'always'`                          | Предупреждение о пустых объектных типах. `allowInterfaces: 'always'` — пустые `interface {}` разрешены (часто используются как маркеры) |

---

### 7. Порядок импортов (`import-x/order`)

Правило из `eslint-plugin-import-x` задаёт порядок импортов в `.ts` и `.vue`:

| Группа     | Описание                                                                   |
| ---------- | -------------------------------------------------------------------------- |
| `builtin`  | Встроенные модули Node.js                                                  |
| `external` | Внешние пакеты: сначала `vue` и пакеты с `vue` в названии, затем остальные |
| `internal` | Алиасы `@/`: app → pages → widgets → features → entities → shared          |
| `parent`   | Относительные `../`                                                        |
| `sibling`  | Относительные `./`                                                         |
| `index`    | `./` или `./index`                                                         |

| Опция                           | Значение                                                                                                             |
| ------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| `pathGroups`                    | Паттерны для vue, `*vue*`, `@/app/**`, `@/pages/**`, `@/widgets/**`, `@/features/**`, `@/entities/**`, `@/shared/**` |
| `pathGroupsExcludedImportTypes` | `['builtin']` — vue и _vue_ участвуют в pathGroups                                                                   |
| `sortTypesGroup`                | `true` — type-only импорты сортируются вместе с обычными по группам                                                  |
| `newlines-between`              | `'always'` — пустая строка между группами                                                                            |
| `alphabetize`                   | `{ order: 'asc', caseInsensitive: true }` — сортировка внутри группы                                                 |

---

### Скрипты ESLint в package.json

| Скрипт     | Команда          | Описание                                   |
| ---------- | ---------------- | ------------------------------------------ |
| `lint`     | `eslint .`       | Проверка всех файлов (кроме ignores)       |
| `lint:fix` | `eslint . --fix` | Проверка и автоисправление того, что можно |

---

## Prettier

Конфигурация: `.prettierrc`

| Параметр                  | Значение | Описание                                                          |
| ------------------------- | -------- | ----------------------------------------------------------------- |
| `semi`                    | `false`  | Без точек с запятой в конце выражений                             |
| `singleQuote`             | `true`   | Одинарные кавычки для строк (`'hello'` вместо `"hello"`)          |
| `tabWidth`                | `4`      | Ширина отступа — 4 пробела                                        |
| `singleAttributePerLine` | `true`   | Каждый атрибут в HTML/Vue/JSX на своей строке                     |
| `trailingComma`           | `"none"` | Без trailing comma — последний элемент списка/объекта без запятой |
| `printWidth`              | `120`    | Максимальная длина строки перед переносом — 120 символов           |

### Игнорируемые пути (`.prettierignore`)

- `dist`, `node_modules`, `public`
- `*.lock`, `package-lock.json`
- `coverage`
- `public/fonts`

### Скрипты Prettier в package.json

| Скрипт         | Команда              | Описание                              |
| -------------- | -------------------- | ------------------------------------- |
| `format`       | `prettier --write .`  | Форматирование всех файлов проекта   |
| `format:check` | `prettier --check .`  | Проверка без изменений (для CI)       |

---

## lint-staged

Конфигурация в `package.json`:

```json
"lint-staged": {
    "*.{ts,vue}": [
        "eslint --fix",
        "prettier --write"
    ]
}
```

| Параметр           | Значение       | Описание                                                       |
| ------------------ | -------------- | -------------------------------------------------------------- |
| `*.{ts,vue}`       | Маска файлов   | Только `.ts` и `.vue` — остальные расширения не обрабатываются |
| `eslint --fix`     | Первая команда | ESLint с автоисправлением для staged-файлов                    |
| `prettier --write` | Вторая команда | Prettier перезаписывает файлы в staged                         |

Порядок: сначала ESLint (логика, стиль кода), затем Prettier (форматирование). Prettier не трогает логику, ESLint после `eslint-config-prettier` не конфликтует с форматированием.

---

## Husky (pre-commit)

При `git commit` запускается `.husky/pre-commit`, который вызывает `lint-staged`. Таким образом, перед коммитом автоматически выполняются `eslint --fix` и `prettier --write` только для файлов, попавших в stage.

---

## Зависимости (devDependencies)

| Пакет                    | Назначение                                         |
| ------------------------ | -------------------------------------------------- |
| `eslint`                 | Ядро линтера                                       |
| `@eslint/js`             | Рекомендуемые правила для JS                       |
| `typescript-eslint`      | Парсер и правила для TypeScript                    |
| `eslint-plugin-vue`      | Правила для Vue 3                                  |
| `eslint-plugin-import-x` | Правило `import-x/order` — порядок импортов        |
| `eslint-config-prettier` | Отключение конфликтующих с Prettier правил ESLint  |
| `prettier`               | Форматтер кода                                     |
| `lint-staged`            | Запуск линтера/форматтера только для staged-файлов |
| `husky`                  | Git hooks (pre-commit)                             |

`eslint-plugin-vue-scoped-css` установлен, но в текущем `eslint.config.js` не используется — можно добавить при необходимости проверки `<style scoped>` в Vue SFC.
